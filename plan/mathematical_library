import re

# Predpokladáme, že funkcie sú definované ako:
def scitanie(x, y):
    return x + y

def odcitanie(x, y):
    return x - y

def nasobenie(x, y):
    return x * y

def delenie(x, y):
    if y == 0:
        raise ValueError("Nulou delit nemozno")
    return x / y

def eval_expr(expr):
    """
    Evaluates a mathematical expression provided as a string and returns the result.
    The expression can include addition, subtraction, multiplication, and division.
    """
    # Mapovanie operácií na funkcie
    operations = {
        '+': scitanie,
        '-': odcitanie,
        '*': nasobenie,
        '/': delenie,
    }

    # Odstránenie medzier z výrazu
    expr = expr.replace(" ", "")

    # Regular expression pre rozdelenie čísel a operátorov
    tokens = re.findall(r"\d+|[-+*/()]", expr)

    def parse_expr(tokens):
        def next_token():
            return tokens.pop(0)

        def parse_factor():
            token = next_token()
            if token == '(':
                result = parse_expr(tokens)
                next_token()  # Zahoď zatváraciu zátvorku
                return result
            else:
                return float(token)

        def parse_term():
            result = parse_factor()
            while tokens and tokens[0] in ['*', '/']:
                op = next_token()
                result = operations[op](result, parse_factor())
            return result

        result = parse_term()
        while tokens and tokens[0] in ['+', '-']:
            op = next_token()
            result = operations[op](result, parse_term())
        return result

    return parse_expr(tokens)

# Príklad použitia
expr = "3 + 4 * (2 - 1)"
print(eval_expr(expr))
